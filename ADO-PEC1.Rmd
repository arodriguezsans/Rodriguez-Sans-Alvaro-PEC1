---
title: "ADO PEC1"
author: "Álvaro Rodríguez Sans"
date: "2024-10-24"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
if (!require("BiocManager", quietly = TRUE))
    install.packages("BiocManager")

BiocManager::install("SummarizedExperiment")
BiocManager::install("airway")
```

```{r}
library(SummarizedExperiment)
data(airway, package="airway")
se <- airway
se
```

```{r}
assays(se)$counts
```

```{r}
rowRanges(se)
rowRanges(se[3])
rowRanges(se[7])
```

```{r}
colData(se)
```

```{r}
# subset for only those samples treated with dexamethasone
se[, se$dex == "trt"]
```

```{r}
metadata(se)
```

```{r}
metadata(se)$formula <- counts ~ dex + albut
metadata(se)
```

tttttttttttttttttttttttttttttttttttttttttttttttttt

```{r}
nrows <- 200
ncols <- 6
counts <- matrix(runif(nrows * ncols, 1, 1e4), nrows)
counts
```

```{r}
rowRanges <- GRanges(rep(c("chr1", "chr2"), c(50, 150)),
                     IRanges(floor(runif(200, 1e5, 1e6)), width=100),
                     strand=sample(c("+", "-"), 200, TRUE),
                     feature_id=sprintf("ID%03d", 1:200))
rowRanges
```

```{r}
colData <- DataFrame(Treatment=rep(c("ChIP", "Input"), 3),
                     row.names=LETTERS[1:6])
colData
```

```{r}
SummarizedExperiment(assays=list(counts=counts),
                     rowRanges=rowRanges, colData=colData)
```

```{r}
SummarizedExperiment(assays=list(counts=counts), colData=colData)
```

ttttttttttttttttttttttttttttttttttttttttttttttttttttttt

```{r}
a1 <- matrix(runif(24), ncol=6, dimnames=list(letters[1:4], LETTERS[1:6]))
a2 <- matrix(rpois(24, 0.8), ncol=6)
a3 <- matrix(101:124, ncol=6, dimnames=list(NULL, LETTERS[1:6]))
se3 <- SummarizedExperiment(SimpleList(a1, a2, a3))
```

```{r}
dimnames(se3)
```

```{r}
# this is 'a?', but with the top-level dimnames on it
assay(se3, 1)
assay(se3, 2)
assay(se3, 3)
```

```{r}
assay(se3, 1, withDimnames=FALSE)  # identical to 'a1'
assay(se3, 2, withDimnames=FALSE)  # identical to 'a2'
assay(se3, 3, withDimnames=FALSE)  # identical to 'a3'
```

```{r}
rownames(se3) <- strrep(letters[1:4], 3)
dimnames(se3)
```

```{r}
assay(se3, 1)  # this is 'a1', but with the top-level dimnames on it
assay(se3, 1, withDimnames=FALSE)  # identical to 'a1'
```

```{r}
# subset the first five transcripts and first three samples
se[1:5, 1:3]
```

```{r}
se[, se$cell == "N61311"]
```

```{r}
# subset the first five transcripts and first three samples
se[1:5, 1:3]
```

```{r}
se[, se$cell == "N61311"]
```

```{r}
counts <- matrix(1:15, 5, 3, dimnames=list(LETTERS[1:5], LETTERS[1:3]))
counts
dates <- SummarizedExperiment(assays=list(counts=counts),
                              rowData=DataFrame(month=month.name[1:5], day=1:5))
dates
```

```{r}
assays(se)
```

```{r}
assays(se)[[1]][1:5, 1:5]
# assay defaults to the first assay if no i is given
assay(se)[1:5, 1:5]
assay(se, 1)[1:5, 1:5]
```

```{r}
# Subset for only rows which are in the interval 100,000 to 110,000 of
# chromosome 1
roi <- GRanges(seqnames="1", ranges=100000:1100000)
subsetByOverlaps(se, roi)
```

```{r}
sessionInfo()
```

```{r}

# Creando un SummarizedExperiment con datos de expresión simulados
counts <- matrix(rpois(1000, lambda = 10), ncol = 10)  # Datos de conteo
row_data <- DataFrame(gene_id = paste0("gene", 1:100)) # Metadatos de genes
col_data <- DataFrame(sample_id = paste0("sample", 1:10), 
                      condition = rep(c("control", "treated"), 5)) # Metadatos de muestras

se <- SummarizedExperiment(assays = list(counts = counts),
                           rowData = row_data,
                           colData = col_data)

# Resumen del objeto
se
```

```{r}

if (!requireNamespace("BiocManager", quietly = TRUE)) {
  install.packages("BiocManager")
}
BiocManager::install(c("SummarizedExperiment", "GenomicRanges"))

library(SummarizedExperiment)
library(GenomicRanges)

# Definir rangos genómicos para los genes
gr <- GRanges(seqnames = Rle(c("chr1", "chr2"), c(50, 50)),
              ranges = IRanges(start = c(1:100), width = 100))

# Crear matriz de conteo de expresión
counts <- matrix(rpois(1000, lambda = 10), ncol = 10)

# Metadatos de muestras
col_data <- DataFrame(sample_id = paste0("sample", 1:10), 
                      condition = rep(c("control", "treated"), 5))

# Crear el objeto RangedSummarizedExperiment
rse <- RangedSummarizedExperiment(assays = list(counts = counts),
                                  rowRanges = gr,
                                  colData = col_data)

# Resumen del objeto
rse
```

```{r}
library(SummarizedExperiment)

# Creando un SummarizedExperiment de ejemplo
se <- SummarizedExperiment(assays = list(counts = matrix(1:100, nrow = 10)),
                           colData = DataFrame(group = rep(c("control", "treatment"), each = 5)))

# Añadiendo metadatos a colData (información sobre las muestras)
colData(se)$batch <- rep(c("batch1", "batch2"), each = 5)
colData(se)$date <- as.Date(rep(c("2023-01-01", "2023-02-01"), each = 5))

# Añadiendo metadatos a rowData (información sobre los genes)
rowData(se)$gene_symbol <- paste0("gene", 1:10)
rowData(se)$chromosome <- sample(c("chr1", "chr2"), 10, replace = TRUE)
```

```{r}

```

```{r}

```

```{r cars}
```

```{r pressure, echo=FALSE}
```

